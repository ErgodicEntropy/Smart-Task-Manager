{% extends 'base.html' %}

{% block head %}
    <style>
        .completed {
            text-decoration: line-through;
            background-color: #e0ffe0;
            color: green;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .finish-button {
            background-color: #4CAF50;
            color: white;
            padding: 5px 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .finish-button:hover {
            background-color: #45a049;
        }

        .task-row {
            transition: background-color 0.3s ease;
        }

        .task-row.finished {
            background-color: #e0ffe0;
        }
    </style>
{% endblock %}

{% block body %}
<div class="content">
    <h1 style="text-align:center">Optimal Task List</h1>
    <p style="text-align:center">Here is your task list aligned with your energy level!</p>
    
    <table>
        <thead>
            <tr>
                <th>Task</th>
                <th>Energy Requirement</th>
                <th>Preparation</th>
                <th>Task Type</th>
                <th>Recommended Start Time</th>
                <th>State</th>
            </tr>
        </thead>
        <tbody>
            {% for task in optimal_task_list %}
                <tr class="task-row" id="task-{{ loop.index }}">
                    <td class="{% if task.finished %}completed{% endif %}">{{ task.content }}</td>
                    <td>{{ task.energy_required }}</td>
                    <td>{{ task.preparation }}</td>
                    <td>{{ task.task_type }}</td>
                    <td>{{ task.recommended_start_time }}</td>
                    <td>
                        <a href="#" class="todo-button" onclick="markAsToDo('{{ loop.index }}')">To Do</a><br>
                    </td>    
                    <td>
                        <a href="#" class="doing-button" onclick="markAsDoing('{{ loop.index }}')">Doing</a><br>
                    </td>    
                    <td>
                        <a href="#" class="done-button" onclick="markAsDone('{{ loop.index }}')">Done</a><br>
                    </td>    
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Chat Conversation Form (to send user message) -->
    <form action="/recommendation" method="GET">
        <input type="submit" value="Get Recommendations!">
    </form> 
</div>

<!-- Kanban Board -->
<script>
    function markAsToDo(taskId) {
        const taskRow = document.getElementById('task-' + taskId);
        taskRow.classList.remove('finished', 'doing');
        taskRow.classList.add('todo');
    }

    function markAsDoing(taskId) {
        const taskRow = document.getElementById('task-' + taskId);
        taskRow.classList.remove('finished', 'todo');
        taskRow.classList.add('doing');
    }

    function markAsDone(taskId) {
        const taskRow = document.getElementById('task-' + taskId);
        taskRow.classList.remove('todo', 'doing');
        taskRow.classList.add('finished');
    }
</script>

<style>
    .todo {
        background-color: #ffcccc;
        transition: background-color 0.3s ease;
    }

    .doing {
        background-color: #ffffcc;
        transition: background-color 0.3s ease;
    }

    .finished {
        background-color: #ccffcc;
        transition: background-color 0.3s ease;
    }
</style>

{% endblock %}
